<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
<head> 
 <meta name="viewport" content="width=device-width, user-scalable=no" />
<script src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>

	
		 <style>
         body {
         background:#ddd;
         }
		 #mapCanvas {
    width: 150px;
    height: 150px;
	margin-left: auto;
	margin-right: auto;
  }
  	 .pic{
    width: 300px;
    height: 300px;
	border: 1px;
  }
  #panicbutton{
		position: relative;
		display: block;
		left: 85%;
	}

 #panicbutton2{
		position: relative;
		display: block;
		left: 85%;
	}
	

      </style>
    </head>
    <body>

<div data-role="page" id="one" data-theme="d">
<div data-role="panel" id="myPanel" data-display="overlay" data-swipe-close="true" data-theme="d">
    		<ul data-role="listview" data-icon="false" data-theme="d">
			
			
	        <li data-role="list-divider" data-theme="">MENU</li>  
	          
	          <li><a href="#userguide" class="ui-btn ui-btn-a ui-shadow ui-btn-icon-right ui-icon-info">User Guide</a></li>

	          <li><a href="#myreports" onClick="reports1()" class="ui-btn ui-btn-a ui-shadow ui-btn-icon-right ui-icon-info">My Reports</a></li>  			  
	            <li><a href="#three" class="ui-btn ui-btn-a ui-shadow ui-btn-icon-right ui-icon-info">Social Feeds</a></li>
			<li><a href="javascript:logoutaccount();" class="ui-btn ui-btn-a ui-shadow ui-btn-icon-right ui-icon-action">Logout</a></li>
			
						
			</ul>
	</div><!-- /panel -->

	<div data-role="header">
        <a href="#myPanel" class="ui-btn ui-icon-bars ui-btn-icon-notext " style="padding:0;border:0;background:transparent;"></a>
		<h1>SOS MANILA</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div id="panicbutton">
		
		<a href="sms:+639461461134?body=I am in emergency situation, I need help." ><img id="panicpic" src="images/panicbutton.png" style="width: 15%;" /></a>
		</div>
		<div id="panicbutton2" style="display:none">
            <a href="#popupStop" data-rel="popup" data-position-to="window" data-transition="pop"><img id="panicpic2" src="images/panicbutton_disabled.png" style="width: 15%;" /></a>
		</div>

	<center>
	<a href="#both" data-role="button" style=" width:75%;" data-rel="popup" data-transition="fade"  data-theme="d" id="logo1" data-position-to="window"><img src="images/logo-small.png"  id="myLogo1" style=" width:100%;"></a>
		
	</center>
		
		<div id="both" data-role="popup" data-theme="d" data-overlay-theme="b">

		 <div class="ui-grid-a">
		  <div class="ui-block-a">
		<a  data-role="button" id="camera" data-theme="d" onClick="next1();"  ><img src="images/logo-camera.png"  id="myLogo" style="width:100%" ></a>
		</div>
		 <div class="ui-block-b">
		 <a  data-role="button" id="camera2"  data-theme="d" onClick="next1();" ><img src="images/logo-album.png"  id="myLogo" style="width:100%"></a>


	
</div>
		</div></div>
	
	
		<a id="btnCall" href="tel:09461461134"  class="ui-btn ui-shadow ui-corner-all ui-icon-phone ui-btn-icon-left ui-btn-d">Emergency</a>
		
		<center>	<label id="lugar1"></label></center>

        <div data-role="popup" id="popupStop" data-theme="d" class="ui-corner-all">
          
                <div style="padding:10px 20px;">
                    <h3>Please Input Password</h3>
       
                    <label for="pw" class="ui-hidden-accessible">Password:</label>
                    <input type="password" name="pass" id="verifypw" value="" placeholder="password" data-theme="d">
                    <button id="verifybtn" class="ui-btn ui-shadow ui-corner-all ui-icon- ui-btn-icon-left ui-btn-d">OK</button>
                </div>
                </div>



		</div>
</div><!-- /page one -->




<!-- Start of second page: #two -->


<div data-role="page" id="two" data-theme="d">
<div data-role="header">
    <a href=""  onclick="lipat();" class="ui-btn ui-icon-back ui-btn-icon-notext" style="padding:0;border:0;background:transparent;"></a><h1>Report Incident </h1>
    <a href="" onclick="lipat();" class="ui-btn ui-icon-home ui-btn-icon-notext" style="padding:0;border:0;background:transparent;"></a>
		
	</div><!-- /header -->
	
<div data-role="main" class="ui-content">

	
<div id="txtDisplayUser" ></div> <div id="txtDateTime"></div>
<!--code ko-->
    	
        
		<br><br>	
  
	<img src="" id="picc"  class="pic" style="margin-left: auto; width:100%; height:80%; margin-right: auto;"   />	
	 
<br>
<legend>Choose an Incident:</legend>
	
	<div class="ui-grid-a">
	
	
    <div class="ui-block-a">
		<input onClick="radio6a();" type="radio" name="txtIncident" id="radio-choice-h-6a" value="disaster">
			<label for="radio-choice-h-6a">Disaster</label>
			</div>
			<div class="ui-block-b">
	
	
	<div id="divSelectDisaster" onClick="sample();" style="display:none;" >
	<select  name="txtTypeIncident" id="txtTypeIncidentDisaster2" data-native-menu="false">
	    <option >Select Disaster Type</option>
	    <option value="CBRN">CBRN</option>
	    <option value="Explosion">Explosion</option>
	    <option  value="Fire">Fire</option>
	    <option  value="Flooding">Flooding</option>
		<option   value="Mitigate">Mitigate</option>
	</select>
	</div>
		</div>	
			
	<div class="ui-block-a">
		<input onClick="radio6b();" type="radio" name="txtIncident" id="radio-choice-h-6b" value="accident">
			<label for="radio-choice-h-6b">Accident</label>
			</div>
			
			<div class="ui-block-b">
	<div id="divSelectAccident" onClick="sample3();" style="display:none;" >
	<select name="txtTypeIncident" id="txtTypeIncidentAccident" data-native-menu="false">
	    <option> Select Accident Type</option>
	    <option value="Car Accident">Car Accident</option>
	    <option value="Motorcycle Accident">Motorcycle Accident</option>
	 
	</select>
	</div>
</div>
			

	<div class="ui-block-a">
		<input onClick="radio6c();" type="radio" name="txtIncident" id="radio-choice-h-6c" value="crime">
			<label for="radio-choice-h-6c">Crime</label>
	</div>
	
	 <div class="ui-block-b">
	
	<div id="divSelectCrime" onClick="sample2();" style="display:none;" >
	<select name="txtTypeIncident" id="txtTypeIncidentCrime" data-native-menu="false">
	    <option>Select Crime Type</option>
		<option value="Abuse">Abuse</option>
	    <option value="Carjacking">Carjacking</option>
	    <option value="Carnapping">Carnapping</option>
		<option value="GunShot">Gun Shot</option>
	    <option value="Homicide">Homicide</option>
		<option value="IllegalDrugTrade">Illegal Drug Trade</option>
	    <option value="Murder">Murder</option>
		<option value="PhysicalInjury">Physical Injury</option>
		<option value="Rape">Rape</option>
		<option value="Robbery">Robbery</option>
		<option value="Theft">Theft</option>
	</select>
	</div>
</div>
	
	
	<div class="ui-block-a">
		<input onClick="radio6d();" type="radio" name="txtIncident" id="radio-choice-h-6d" value="medical">
			<label for="radio-choice-h-6d">Medical</label>
	</div>
	
	
	<div class="ui-block-b">
	<div id="divSelectMedicalAssistance" onClick="sample4();" style="display:none;">
	<select name="txtTypeIncident" id="txtTypeIncidentMedicalAssistance" data-native-menu="false">
	    <option>Select Med Assist Type</option>
	    <option value="Asthma">Asthma</option>
	    <option value="BrokenBone">Broken Bone</option>
	    <option value="Dengue">Dengue</option>
	<option value="EmergencyChildbirth">Emergency Childbirth</option>
	<option value="HeartAttack">Heart Attack</option>
	<option value="Poisoning">Poisoning</option>
	</select>
	</div>
	</div>
	
	
	<div class="ui-block-a">
		<input onClick="radio6e();" type="radio" name="txtIncident" id="radio-choice-h-6e" value="other">
			<label for="radio-choice-h-6e">Other</label>
	<!--</fieldset>-->
	</div>
	
	
	
    
	
	


        <div class="ui-block-b" id ="otherhider" style="display:none;">
            <input type="text" onchange="sample5();" name="txtother" id="txtother" placeholder="Other" />
        </div>
	</div>
	
</div><!-- /grid-a -->
	
 <label for="txtFactsIncident">Facts of incident:</label>
	<input type="text" name="txtFactsIncident" id="txtFactsIncident" />

	<input type="submit" onClick="next2();" value="Send" id="submit" data-theme="d" />

<!-- end code ko--> 

	
<!--code ko--> 
   
	
	
	
<!-- end code ko-->
				
   
		   
		   
		   </div>

<!-- /page two -->


<div data-role="page" id="four" data-theme="d">



	<div data-role="header">
        <a href="#two" class="ui-btn ui-icon-back ui-btn-icon-notext" style="padding:0;border:0;background:transparent;"></a>
		<h1>Summary</h1>
        <a href="" onclick="lipat();" class="ui-btn ui-icon-home ui-btn-icon-notext" style="padding:0;border:0;background:transparent;"></a>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		
		<br>           
<table border="0"  style="  margin-left: auto;  margin-right: auto;">
<tr>
<td>	 <img src="" class="pic" id="picc1" border="1"  style="margin-left: auto; width:100%; height:40%;  margin-right: auto;"  />	
</td>

<td ><div id="mapCanvas"     ></div>
</td>
</tr>
</table><br>
			
<p id="pdate">	Date: </p>
<p id="pname">	By: </p>
<p id="pRincedent"> Incedent: </p>
<p id="pincedent">	Type of Incedent: </p>
<p id="pfact"> fact:</p>
 <br> 
       <input type="button" onClick="next3();" value="Send" id="submit" data-theme="d" >
	   
	   <br>
	   
	
	</div><!-- /content -->

	

</div><!-- /page one -->







<div data-role="page" id="five" data-theme="d">



	<div data-role="header">
	<h1>Sending</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		
   
	   

<div id="ew">
<center>
<br><br>
 <img src="images/ajax-loader.gif"  />
<br><br>
Report Sending Please Wait... 
  </center>
</div>
	</div><!-- /content -->

	

</div><!-- /page one -->









<div data-role="page" id="myreports" data-theme="d">

	<div data-role="header">
	
		<a href="" data-rel="back" class="ui-btn ui-icon-back ui-btn-icon-notext"></a>
	<h1>My Reports</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		
   
	   

<div id="reports1" style=" text-align: left;">
<center>
 <img src="images/ajax-loader.gif"  />
  <br>
 Loading Please Wait... 
 
 </center></div>


	</div><!-- /content -->

	

</div><!-- /page one -->









<div data-role="page" id="three" data-theme="d">



	<div data-role="header">
		<a href="" data-rel="back" class="ui-btn ui-icon-back ui-btn-icon-notext"></a>
		<h1>News Feeds</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		
		<div id="twitter-feed"></div>
	</div><!-- /content -->

	

</div><!-- /page one -->


<div data-role="page" id="userguide" data-theme="d">



	<div data-role="header">
		<a href="" data-rel="back" class="ui-btn ui-icon-back ui-btn-icon-notext"></a>
		<h1>User Guide</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		
		<img src="images/construction.png" style="width:70%;margin-left:auto;margin-right:auto;display:block" />
	</div><!-- /content -->


</div><!-- /page one -->






<div data-role="page" id="mgahidden">



	<div data-role="header">
		<a href=""  class="ui-btn ui-icon-back ui-btn-icon-notext"></a>
		<h1>mga hidden</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
	         <p id="info2" style="display:none;"></p>
			 <p id="info33" style="display:none;"></p>
			    <p id="info" style="display:none;"></p>
<input type="hidden" id="asar">
 <input type="hidden" id="pic1" />
 <input type="hidden" id="pic2" >
 <input type="hidden" id="pic3" />

 <input type="hidden" id="hidlat" />

  <input type="hidden" id="sample" />
  <div id="infoPanel"  style="display:none;" >
    <b>Marker status:</b>
    <div id="markerStatus"><i>Click and drag the marker.</i></div>
    <b>Current position:</b>
    
    <b>Closest matching address:</b>
    <div id="address"></div>
  </div>
  
	
	   <div id="deviceready" class="blink">
                <p class="event listening" style="display:none;" >Connecting to Device</p>
                <p class="event received" style=" display:none;">Device is Ready</p>
            </div>
	
	
	
</div><!-- /content -->


</div><!-- /page one -->




<!-- code ko -->
    <script src="js/jquery-1.10.2.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css" />
	<script src="js/jquery.mobile-1.4.5.min.js"></script>
	<link rel="stylesheet" href="css/themes/my-custom-theme.min.css" />  
	<script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/Toast.js"></script>
	<script type="text/javascript" src="js/twitterfeed.js"></script>	
	
	<script type="text/javascript">
getLocation();
pangdate();
	var timerId = 0;
	var locinterval = 0;
	var incidentV ;
	var factV;
	var name55;
var loc2;
var cat2 ;
var cat22 ;
var address2 ;
var date2;
var long2 ;
var lat2;
var pic1;
var skip2 = 0;

var sampleV;
var Rincident ;

var geocoder = new google.maps.Geocoder();

  var gg;
  var gg1;
function geocodePosition(pos) {
  geocoder.geocode({
    latLng: pos
  }, function(responses) {
    if (responses && responses.length > 0) {
      updateMarkerAddress(responses[0].formatted_address);
    } else {
      updateMarkerAddress('Cannot determine address at this location.');
    }
  });
}

function updateMarkerStatus(str) {
  document.getElementById('markerStatus').innerHTML = str;
}

function updateMarkerPosition(latLng) {
  document.getElementById('info2').innerHTML = [
    latLng.lat(),
    latLng.lng()
  ].join(', ');
}

function updateMarkerAddress(str) {
document.getElementById('lugar1').innerHTML = str;
  loc2 = str;
  
}

 function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.watchPosition(showPosition);
    }
  else{}
  }
function showPosition(position)
  {
	
  gg =position.coords.latitude ;
 gg1 =  position.coords.longitude;
  
  
  long2 =position.coords.latitude;
  lat2= position.coords.longitude;
window.localStorage.setItem("longlat",long2);

window.localStorage.setItem("lat",lat2);
initialize();

  }

function initialize() {

  
  var latLng = new google.maps.LatLng(gg,gg1);
 
 var map = new google.maps.Map(document.getElementById('mapCanvas'), {
    zoom: 12,
    center: latLng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });
  var marker = new google.maps.Marker({
    position: latLng,
    title: 'Point A',
    map: map
  });

 
  
  // Update current position info.
  updateMarkerPosition(latLng);
  geocodePosition(latLng);

  // Add dragging event listeners.
  google.maps.event.addListener(marker, 'dragstart', function() {
    updateMarkerAddress('Dragging...');
  });

  google.maps.event.addListener(marker, 'drag', function() {
    updateMarkerStatus('Dragging...');
    updateMarkerPosition(marker.getPosition());
  });

  google.maps.event.addListener(marker, 'dragend', function() {
    updateMarkerStatus('Drag ended');
    geocodePosition(marker.getPosition());
  });
}




 app.initialize();
function pangdate(){

var d = new Date();
		d = d.toLocaleTimeString().replace(/:\d+ /, ' ');
		var d1 = new Date();
		
		 document.getElementById("pdate").innerHTML ="Date: " + d1.toDateString() +" "+ d;
		 date2 =  d1.toDateString() +" "+ d;

document.getElementById('txtDateTime').innerHTML = "Date: " + d1.toDateString() +" "+ d;

document.getElementById("txtDisplayUser").innerHTML ="Username: " + window.localStorage.getItem('dataemail');
name55 = window.localStorage.getItem('dataemail');
}


function logoutaccount()
	{
	localStorage.removeItem("datausername");
	localStorage.removeItem("dataemail");
	
window.location.replace("index.html");
	// $.mobile.changePage("index.html", { transition: "fade", changeHash: true});
	}



//code ng select disaster
function radio6a(){
		    $( "#divSelectDisaster" ).show("fast");
		   $( "#divSelectCrime" ).hide("fast");
		  $( "#divSelectAccident" ).hide("fast");
		  $( "#divSelectMedicalAssistance" ).hide("fast");
		$("#otherhider").hide("fast");
		$("#txtTypeIncidentDisaster2").selectmenu( "open" );
}
function radio6b(){
		    $( "#divSelectDisaster" ).hide("fast");
		   $( "#divSelectCrime" ).hide("fast");
		  $( "#divSelectAccident" ).show("fast");
		  $( "#divSelectMedicalAssistance" ).hide("fast");
		  $("#otherhider").hide("fast");
		  	$("#txtTypeIncidentAccident").selectmenu( "open" );
}
function radio6c(){
		  $( "#divSelectDisaster" ).hide("fast");
		   $( "#divSelectCrime" ).show("fast");
		  $( "#divSelectAccident" ).hide("fast");
		  $( "#divSelectMedicalAssistance" ).hide("fast");
		  $("#otherhider").hide("fast");
          	$("#txtTypeIncidentCrime").selectmenu( "open" );
}
function radio6d(){
		  $( "#divSelectDisaster" ).hide("fast");
		   $( "#divSelectCrime" ).hide("fast");
		  $( "#divSelectAccident" ).hide("fast");
		  $( "#divSelectMedicalAssistance" ).show("fast");
		  $("#otherhider").hide("fast");
		  $("#txtTypeIncidentMedicalAssistance").selectmenu( "open" );
		  }
function radio6e(){
		  $( "#divSelectDisaster" ).hide("fast");
		   $( "#divSelectCrime" ).hide("fast");
		  $( "#divSelectAccident" ).hide("fast");
		  $( "#divSelectMedicalAssistance" ).hide("fast");
		  $( "#otherhider" ).show("fast");

}


//data ng selecttype
var sampleV;
var Rincident;
function sample(){
document.getElementById("sample").value= document.getElementById("txtTypeIncidentDisaster2").value;
sampleV = 1;
}
function sample2(){
document.getElementById("sample").value= document.getElementById("txtTypeIncidentCrime").value;
sampleV = 2;
}
function sample3(){
document.getElementById("sample").value= document.getElementById("txtTypeIncidentAccident").value;
sampleV = 3;
}
function sample4(){
document.getElementById("sample").value= document.getElementById("txtTypeIncidentMedicalAssistance").value;
sampleV = 4;
}
function sample5(){
document.getElementById("sample").value= document.getElementById("txtother").value;
sampleV = 5;
}

function sample6(){
	if(sampleV==1){
	Rincident = "disaster";
	sample();
	}else if(sampleV==2){
	
	Rincident = "crime";
	sample2();
	}else if(sampleV==3){
	
	Rincident = "accident";
	sample3();
	}else if(sampleV==4){
	Rincident = "medical";
	sample4();
	}else if(sampleV==5){
	Rincident = "other";
	sample5();
	}
}
//end select

function lipat(){
window.location.replace("home.html");
}

function Back1(){
window.location.replace("home.html");
}
function Back2(){
window.location.replace("#two");
}

function next1(){

window.location.replace("#two");

}





  function next2(){
				sample6();
window.location.replace("#four");
			incidentV = document.getElementById("sample").value;
			factV  = document.getElementById("txtFactsIncident").value;
			name55 = window.localStorage.getItem('dataemail');

			pic1 =  document.getElementById("info33").innerHTML;
		
		 document.getElementById("pname").innerHTML ="By: " + name55;
		 
		 document.getElementById("pRincedent").innerHTML ="Incident: " + Rincident;
		 document.getElementById("pincedent").innerHTML ="Type of Incident: " + incidentV;
		 document.getElementById("pfact").innerHTML ="Fact of Incident: " + factV;
		
		
	
	}



function next3(){
		
		    
var pic = pic1;	

                window.location.replace("#five");

				$.ajax({
					url: "http://iligtas.ph/sosManila/addreport.php",
					type: "POST",
					data: {"txtIncident":Rincident,"txtPhotoIncident":pic,"txtDisplayUser":name55,"txtDateTime":date2,"txtTypeIncident":incidentV,"txtFactsIncident":factV,"txtlong":long2,"txtlat2":lat2,"loc2":loc2},
					success:function(data){
					
					window.plugins.toast.showLongBottom('Incident Report Sent!', function(a){console.log('toast success: ' + a)}, function(b){alert('toast error: ' + b)});
					lipat();
	}
	});	
		   
			}
			

function reports1(){
myname = window.localStorage.getItem('dataemail');
				$.ajax({
					url: "http://iligtas.ph/sosManila/myreports.php",
					type: "POST",
					data: {"myname":myname},
					success:function(data){
						$("#reports1").html(data);
		
	}
	});	
		   
			}
			

			$(document).ready(function(){
  $("#panicpic").click(function(){
  $("#panicbutton").hide();
  $("#panicbutton2").show();
  
myname = window.localStorage.getItem('dataemail');
 	
				$.ajax({
					url: "http://iligtas.ph/sosManila/textalert.php",
					type: "POST",
					data: {"txtDisplayUser":myname,"txtDateTime":date2,"txtlong":long2,"txtlat2":lat2,"loc2":loc2},
					success:function(data){
						
		
	}
	});	
	
	

	timerId = window.setInterval(function(){
	
				$.ajax({
					url: "http://iligtas.ph/sosManila/textalert.php",
					type: "POST",
					data: {"txtDisplayUser":myname,"txtDateTime":date2,"txtlong":long2,"txtlat2":lat2,"loc2":loc2},
					success:function(data){
						
		
	}
	});	
	
}, 60000);


  });
  
locinterval = window.setInterval(function(){

getLocation();
pangdate();
}, 30000);


  $("#panicpic2").click(function(){
  $("#panicbutton").hide();
  $("#panicbutton2").show();
  $('#popupStop').show();
  });

  
  $("#verifybtn").click(function () {
      var userpw = window.localStorage.getItem('datapassword');
      var inputpw = document.getElementById("verifypw").value;
 
    if (userpw == inputpw) {


          $("#panicbutton2").hide();
          $("#panicbutton").show();

          clearInterval(timerId);
	$('#popupStop').hide();
	document.getElementById("verifypw").value="";
      }
      else {
		$('#popupStop').hide();
		document.getElementById("verifypw").value="";
		
          alert("Wrong Password!");
      }

  });
  
});


</script>


</body>
</html>
